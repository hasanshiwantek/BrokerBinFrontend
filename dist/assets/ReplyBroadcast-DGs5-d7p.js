import{a as P,k as q,u as w,r as m,b as v,j as e,L as c,M as G}from"./index-SDeZWYlL.js";import{m as H}from"./BroadcastFilters.module-D28EjqF3.js";import{s as n}from"./BroadCast.module-BcBQXTQ_.js";import{R as I}from"./quill.snow-DDG868ul.js";const z=()=>{var b,j;const k=P(),S=q(),R=w(),[s,O]=m.useState(((b=S.state)==null?void 0:b.broadcast)||JSON.parse(localStorage.getItem("broadcastData")));(j=s==null?void 0:s.user_id)!=null&&j.email,v.get("user_id");const _=v.get("token"),h=()=>{var y,g,f,N,C,$;if(!s)return"Broadcast data is not available.";const t=((y=s.user_id)==null?void 0:y.firstName)||"",o=((g=s.user_id)==null?void 0:g.lastName)||"",i=((N=(f=s.user_id)==null?void 0:f.company)==null?void 0:N.name)||"",r=((C=s.user_id)==null?void 0:C.phoneNumber)||"",p=(($=s.user_id)==null?void 0:$.email)||"",u=s.mfg||"",D=s.partModel||"",E=s.cond||"",F=s.quantity||"",M=s.price||"",T=s.additional_comments||"",L=s.description||"";return`- ------------------ -<br />
    ${t} ${o}<br />
    ${i}<br />
    P: ${r}<br />
    ${p}<br />
    <br />
    - ------------------ -<br />
    Original Broadcast Details<br />
    MFG: ${u}<br />
    Part No: ${D}<br />
    Condition: ${E}<br />
    Quantity: ${F}<br />
    Price: ${M}<br />
    Comments: ${T}<br />
    Description: ${L}<br />`},[a,l]=m.useState({to:s?`${s.user_id.email} `:"",subject:s?`Re: ${s.type} : ${s.mfg} : ${s.partModel} : ${s==null?void 0:s.additional_comments} : ${s==null?void 0:s.description}`:"",comments:s?h():"",sendCopy:!1}),B=t=>t.replace(/<\/p>/g,`
`).replace(/<p>/g,"").replace(/<br\s*\/?>/gi,`
`).replace(/<\/?[^>]+(>|$)/g,"");m.useEffect(()=>{s&&l(t=>({...t,comments:h()}))},[s]);const d=t=>{const{name:o,type:i,value:r,checked:p}=t.target;l(u=>({...u,[o]:i==="checkbox"?p:r}))},x=t=>{t.preventDefault();const o=B(a.comments),i={emailData:{to:a.to,subject:a.subject,comments:o,sendCopy:a.sendCopy}};console.log("Email Data:",i),k(G({token:_,data:i})).then(r=>{alert("Email sent successfully!"),R("/broadcasts")}).catch(r=>{console.error("Failed to send email:",r),alert("Failed to send email.")})};return m.useEffect(()=>{console.log(s)},[]),e.jsx(e.Fragment,{children:e.jsxs("main",{className:H.profileInfo,children:[e.jsx("nav",{className:"menu-bar",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx(c,{to:"/",children:"Reply"})}),e.jsx("li",{children:e.jsx(c,{to:"/sendbroad",children:"Send"})}),e.jsx("li",{children:e.jsx(c,{to:"/broadcasts",children:"View"})}),e.jsx("li",{children:e.jsx(c,{to:"/myprofile/broadcastfilter",children:"Set Filters"})}),e.jsx("li",{children:e.jsx(c,{to:"/broadcasthistory",children:"History"})})]})}),e.jsxs("div",{className:n.replyform,children:[e.jsx("h2",{children:"Reply To Broadcast"}),e.jsx("div",{className:n.replySec,children:e.jsx("div",{className:n.formGroup,children:e.jsxs("form",{onSubmit:x,className:"mt-10",children:[e.jsx("div",{children:e.jsxs("label",{children:[e.jsx("strong",{children:"To:"}),e.jsx("input",{type:"text",name:"to",value:a.to,onChange:d,className:n.input})]})}),e.jsx("div",{children:e.jsxs("label",{children:[e.jsx("strong",{children:"Subject:"}),e.jsx("input",{type:"text",name:"subject",value:a.subject,onChange:d,className:n.input})]})}),e.jsxs("div",{children:[e.jsx("label",{children:e.jsx("strong",{children:"Comments:"})}),e.jsx(I,{value:a.comments,onChange:t=>l(o=>({...o,comments:t})),className:n.textarea,theme:"snow",modules:{toolbar:[["bold","italic","underline"],["link","image"]]}})]}),e.jsx("div",{className:n.checkboxContainer,style:{marginTop:"80px"},children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",name:"sendCopy",checked:a.sendCopy,onChange:d,style:{marginRight:"5px"}}),"Send a copy to myself"]})})]})})})]}),e.jsxs("div",{className:n.buttonContainer,children:[e.jsx("button",{type:"button",className:n.sendButton,onClick:x,children:"Send"}),e.jsx("button",{type:"button",onClick:()=>l({comments:"",sendCopy:!1}),className:n.resetButton,children:"Reset"})]})]})})};export{z as default};
